<!DOCTYPE html>
<html>
    <head>
    </head>
    <body>
        <video id="myvideo" width="100%" autoplay="true">
            <source src="https://sakugabooru.com/data/375d2b53a342d0c336f5371488cc3102.mp4" type="video/mp4">
            Your browser does not support mp4 video.
        </video>
        <script>
            console.log("starting script");
            const video = document.querySelector('video');

            function getRandomVideo() {
                const url = 'http://localhost:3000/api/post.json?limit=1&page=' + Math.floor(Math.random() * 15390) + '&tags=fighting';
                return fetch(url).then(response => response.json().then(data => data[0].file_url));
            }

            console.log(video);
    
            video.addEventListener('ended', (event) => {
                console.log("getting random video");
                getRandomVideo().then(src => {
                    video.src = src;
                    video.play();
                });
            });
        </script>
    </body>
</html>
