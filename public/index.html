<!DOCTYPE html>
<html>
    <head>
        <style>
            body, html, video {
                margin:0;
                padding:0;
                background:#000;
                height: 100%;
                width: 100%;
            }
            body {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            video {
                object-fit: contain;
            }
            video::-webkit-media-controls {
                display:none !important;
            }
        </style>
    </head>
    <body>
        <video autoplay muted>
            <source type="video/mp4">
            Your browser does not support mp4 video.
        </video>
        <script>
            const video = document.querySelector('video');
            function getRandomVideo() {
                const url = '/api/post.json?limit=1&page=' + Math.floor(Math.random() * 15390) + '&tags=fighting';
                return fetch(url).then(response => response.json().then(data => data[0].file_url));
            }
            video.addEventListener('ended', (event) => {
                getRandomVideo().then(src => {
                    video.src = src;
                    video.play();
                });
            });
            var fullScreenEnabled = !!(document.fullscreenEnabled || document.mozFullScreenEnabled || document.msFullscreenEnabled || document.webkitSupportsFullscreen || document.webkitFullscreenEnabled || document.createElement('video').webkitRequestFullScreen);
            var isFullScreen = function() {
                return !!(document.fullScreen || document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement || document.fullscreenElement);
            }
            var setFullscreenData = function(state) {
                video.setAttribute('data-fullscreen', !!state);
            }
            var handleFullscreen = function() {
                if (isFullScreen()) {
                    if (document.exitFullscreen) document.exitFullscreen();
                    else if (document.mozCancelFullScreen) document.mozCancelFullScreen();
                    else if (document.webkitCancelFullScreen) document.webkitCancelFullScreen();
                    else if (document.msExitFullscreen) document.msExitFullscreen();
                    setFullscreenData(false);
                }
                else {
                    if (video.requestFullscreen) video.requestFullscreen();
                    else if (video.mozRequestFullScreen) video.mozRequestFullScreen();
                    else if (video.webkitRequestFullScreen) video.webkitRequestFullScreen();
                    else if (video.msRequestFullscreen) video.msRequestFullscreen();
                    setFullscreenData(true);
                }
            }
            video.addEventListener('click', handleFullscreen);
            getRandomVideo().then(src => {
                video.src = src;
                video.play();
            })
        </script>
    </body>
</html>
